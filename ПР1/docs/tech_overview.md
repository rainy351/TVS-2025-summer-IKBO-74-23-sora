
# Техническое описание Текстовый Чат (ТЧ-01)

## Архитектура системы

Система использует клиент-серверную архитектуру:

- **Сервер:** Центральный узел, обрабатывающий все соединения и сообщения
- **Клиенты:** Подключаются к серверу для отправки и получения сообщений

## Протокол обмена данными

Связь осуществляется по TCP с использованием текстовых команд:

### Команды аутентификации

- `REGISTER:nickname:password` - регистрация нового пользователя
- `LOGIN:nickname:password` - вход существующего пользователя

### Ответы сервера

- `REGISTER_SUCCESS` - успешная регистрация
- `LOGIN_SUCCESS` - успешный вход
- `USER_EXISTS` - пользователь уже существует
- `USER_NOT_FOUND` - пользователь не найден
- `WRONG_PASSWORD` - неверный пароль
- `INVALID_COMMAND` - неизвестная команда

### Команды чата

- `/quit` - отключение от сервера
- `/online` - запрос списка онлайн-пользователей
- `/?`(на клиенте) - вывод списка команд
- Любой другой текст - отправка сообщения в чат

### Формат сообщений

- Обычные сообщения: `username: text`
- Системные сообщения: `[COLOR]:text`
- Цветовые коды: YLW, GRY, GRN, RED, WHT

## Форматы хранения данных

### Хранение пользователей

Пользователи хранятся в памяти сервера в словаре:

```python
user_database = {
    'nickname1': 'password1',
    'nickname2': 'password2'
}
```

### Хранение истории сообщений

История хранится в памяти сервера как список строк:

```python
history = [
    'user1: message1',
    'user2: message2',
    ...
]
```

### Онлайн-пользователи

Список активных пользователей хранится в памяти:

```python
online_users = ['user1', 'user2']
```

## Развертывание серверной части

### Конфигурация сервера

По умолчанию сервер использует:

- **Хост:** localhost
- **Порт:** 12345
- **Максимальное кол-во подключений:** 5

### Изменение настроек

Для изменения настроек отредактируйте конструктор класса `ChatServer`:

```python
server = ChatServer(host='ваш_хост', port=ваш_порт)
```

### Запуск сервера

```bash
python server.py
```

Сервер запускается в фоновом режиме и обрабатывает подключения в отдельных потоках.

## Клиентские настройки

### Подключение к серверу

По умолчанию клиент подключается к localhost:12345

### Изменение настроек подключения

Отредактируйте конструктор класса `SimpleChatClient`:

```python
client = SimpleChatClient(host='адрес_сервера', port=порт)
```

### Аргументы командной строки

В текущей версии аргументы командной строки не поддерживаются. Настройки изменяются путем редактирования кода.

## Особенности реализации

### Многопоточность

- Сервер использует отдельный поток для каждого клиента
- Клиент использует отдельный поток для прослушивания сообщений от сервера

### Обработка ошибок

- Автоматическое удаление отключившихся клиентов
- Защита от обрывов соединения
- Валидация входящих команд

### Цветовое оформление

Используется библиотека `termcolor` для цветового выделения различных типов сообщений

## Безопасность

- Пароли хранятся в открытом виде в памяти сервера
- Шифрование передаваемых данных не реализовано
- Рекомендуется использовать в доверенных сетях
